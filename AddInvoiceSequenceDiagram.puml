@startuml AddInvoiceSequence
actor "Admin" as User
boundary "PrimaryController (B)" as Boundary
control "AddInvoiceUseCase (C)" as Control
entity "HourlyInvoice (E)" as HourlyEntity
entity "DailyInvoice (E)" as DailyEntity
database "InvoiceDAO" as DAO

User -> Boundary : nhập thông tin hóa đơn
activate Boundary
Boundary -> Control : addInvoice(customer, room, type, unitPrice, hour, day)
activate Control
alt type == "hourly"
    Control -> HourlyEntity : calculateTotal(unitPrice, hour)
    activate HourlyEntity
    HourlyEntity --> Control : trả về tổng tiền hoặc -1 nếu không hợp lệ
    deactivate HourlyEntity
    alt tổng tiền == -1
        Control --> Boundary : thông báo lỗi "Số giờ không được vượt quá 30"
        deactivate Control
        deactivate Boundary
    else tổng tiền hợp lệ
        Control -> DAO : insertInvoice(InvoiceDTO)
        activate DAO
        DAO --> Control : boolean (thành công/thất bại)
        deactivate DAO
        Control --> Boundary : boolean (thành công/thất bại)
        deactivate Control
        Boundary --> User : thông báo kết quả
        deactivate Boundary
    end
else type == "daily"
    Control -> DailyEntity : calculateTotal(unitPrice, day)
    activate DailyEntity
    DailyEntity --> Control : trả về tổng tiền hoặc -1 nếu không hợp lệ
    deactivate DailyEntity
    alt tổng tiền == -1
        Control --> Boundary : thông báo lỗi "Số ngày phải lớn hơn 0"
        deactivate Control
        deactivate Boundary
    else tổng tiền hợp lệ
        Control -> DAO : insertInvoice(InvoiceDTO)
        activate DAO
        DAO --> Control : boolean (thành công/thất bại)
        deactivate DAO
        Control --> Boundary : boolean (thành công/thất bại)
        deactivate Control
        Boundary --> User : thông báo kết quả
        deactivate Boundary
    end
end
@enduml
